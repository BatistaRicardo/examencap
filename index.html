<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>R√©daction Centrale ‚Äì Examen √âducation aux M√©dias & TICE</title>
  <style>
    :root{
      --bg:#0f1115; --card:#171a21; --ink:#eaeef7; --muted:#9aa3b2; --accent:#ffd000; --ok:#00c853; --no:#ff5252;
    }
    *{box-sizing:border-box}
    body{margin:0; font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; background:linear-gradient(180deg,#0f1115,#0b0d12); color:var(--ink);}
    header{position:sticky; top:0; z-index:5; background:#0f1115cc; backdrop-filter:blur(10px); border-bottom:1px solid #232632}
    .wrap{max-width:1100px; margin:0 auto; padding:24px}
    h1{font-size:clamp(22px,3vw,32px); margin:0 0 6px 0}
    p.lead{color:var(--muted); margin:0 0 10px 0}
    .grid{display:grid; grid-template-columns:repeat(3, minmax(0,1fr)); gap:18px}
    .card{background:var(--card); border:1px solid #232632; border-radius:18px; padding:18px; position:relative; box-shadow:0 6px 30px rgba(0,0,0,.25)}
    .card h3{margin:0 0 6px 0}
    .pill{display:inline-flex; align-items:center; gap:6px; border:1px solid #2e3241; border-radius:999px; padding:6px 10px; font-size:12px; color:var(--muted)}
    .btn{display:inline-flex; align-items:center; justify-content:center; gap:8px; padding:10px 14px; border-radius:12px; background:var(--accent); color:#111; font-weight:700; border:none; cursor:pointer}
    .btn[disabled]{opacity:.35; cursor:not-allowed}
    .row{display:flex; gap:12px; flex-wrap:wrap}
    .muted{color:var(--muted)}
    .kbd{background:#121420; color:#e4e7f1; border:1px solid #2a2e3f; padding:2px 6px; border-radius:6px; font-family:ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; font-size:12px}
    .footer{margin-top:24px; color:var(--muted); font-size:13px}
    .badge{position:absolute; top:14px; right:14px; font-size:12px; color:#111; background:var(--accent); border-radius:999px; padding:4px 10px; font-weight:700}
    .badge.done{background:var(--ok)}
    .badge.lock{background:#8892a6; color:#111}
    .stack{display:grid; gap:10px}
    .code-in{display:flex; gap:8px}
    .code-in input{flex:1; padding:10px 12px; border-radius:10px; border:1px solid #2a2e3f; background:#101421; color:var(--ink)}
    .sep{height:1px; background:#232632; margin:16px 0}
    .final{margin-top:8px; background:var(--card); border:1px solid #232632; border-radius:18px; padding:18px}
    dialog{border:none; border-radius:18px; padding:0; background:transparent}
    .modal{background:var(--card); border:1px solid #232632; border-radius:18px; width:min(900px, 92vw); max-height:86vh; overflow:hidden; display:grid; grid-template-rows:auto 1fr auto}
    .modal header{position:static; border:0; background:transparent}
    .modal .head{display:flex; align-items:center; justify-content:space-between; padding:16px 18px; border-bottom:1px solid #232632}
    .modal h2{margin:0; font-size:18px}
    .modal .body{padding:0; background:#0b0f1c}
    .modal iframe{width:100%; height:60vh; border:0}
    .modal .foot{display:flex; gap:10px; align-items:center; justify-content:space-between; padding:12px 16px; border-top:1px solid #232632}
    .hint{font-size:12px; color:var(--muted)}
  .modalText{background:var(--card); border:1px solid #232632; border-radius:18px; width:min(900px, 92vw); max-height:86vh; overflow:hidden; display:grid; grid-template-rows:auto 1fr auto}
    .modalText .head{display:flex; align-items:center; justify-content:space-between; padding:16px 18px; border-bottom:1px solid #232632}
    .modalText .body{padding:18px; background:#0b0f1c; overflow:auto}
    .article h4{margin:8px 0 6px 0}
    .article p{line-height:1.55; color:var(--ink)}
    .article .meta{color:var(--muted); font-size:13px; margin-bottom:8px}
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <h1>R√©daction Centrale ‚Äì Mission D√©masquage</h1>
      <p class="lead">Examen certificatif (1h) ‚Äì √âducation aux M√©dias & TICE ‚Äì Travail individuel ‚Äî Domaine @ipfc-bw.org requis.</p>
    </div>
  </header>

  <main class="wrap">
    <div class="grid" id="rooms">
      <!-- Salle 1 -->
      <section class="card" id="card1">
        <span class="badge lock" id="badge1">√Ä faire</span>
        <h3>üïµÔ∏è Salle 1 ‚Äî Analyse critique : ¬´ 40 % moins intelligents ¬ª</h3>
        <p class="muted">Compare deux articles sur le m√™me sujet. Justifie par 3 indices concrets (source, auteur, date, ton, preuves‚Ä¶). Puis saisis le code affich√© en fin de formulaire.</p>
        <div class="row">
          <button class="btn" id="open1">Ouvrir le Formulaire</button>
          <button class="btn" id="artA" data-which="A" onclick="window.openText && window.openText('A')">Lire l‚ÄôArticle A</button>
          <button class="btn" id="artB" data-which="B" onclick="window.openText && window.openText('B')">Lire l‚ÄôArticle B</button>
          <span class="pill">Dur√©e sugg√©r√©e : 15 min</span>
        </div>
        <div class="sep"></div>
        <div class="stack">
          <label for="code1">Code de fin de salle</label>
          <div class="code-in">
            <input id="code1" placeholder="Entrez le code re√ßu" autocomplete="off" />
            <button class="btn" id="check1">Valider</button>
          </div>
          <div class="hint">Le code appara√Æt dans le message de confirmation du formulaire.</div>
        </div>
      </section>

      <!-- Salle 2 -->
      <section class="card" id="card2">
        <span class="badge lock" id="badge2">Verrouill√©</span>
        <h3>üì∏ Salle 2 ‚Äî Droit d‚Äôauteur & licences (Pixabay)</h3>
        <p class="muted">Choisis une image r√©utilisable l√©galement et r√©dige l‚Äôattribution correcte. Saisis ensuite le code de la salle.</p>
        <div class="row">
          <button class="btn" id="open2" disabled>Ouvrir le Formulaire</button>
          <span class="pill">Dur√©e sugg√©r√©e : 20 min</span>
        </div>
        <div class="sep"></div>
        <div class="stack">
          <label for="code2">Code de fin de salle</label>
          <div class="code-in">
            <input id="code2" placeholder="Entrez le code re√ßu" autocomplete="off" />
            <button class="btn" id="check2" disabled>Valider</button>
          </div>
          <div class="hint">Le code appara√Æt dans le message de confirmation du formulaire.</div>
        </div>
      </section>

      <!-- Salle 3 -->
      <section class="card" id="card3">
        <span class="badge lock" id="badge3">Verrouill√©</span>
        <h3>üé§ Salle 3 ‚Äî Choix d‚Äôoutil p√©dagogique (Langues)</h3>
        <p class="muted">Choisis l‚Äôoutil le plus pertinent (TBI + PC prof, sans PC √©l√®ves) pour stimuler la participation orale, et justifie. Saisis ensuite le code.</p>
        <div class="row">
          <button class="btn" id="open3" disabled>Ouvrir le Formulaire</button>
          <span class="pill">Dur√©e sugg√©r√©e : 20 min</span>
        </div>
        <div class="sep"></div>
        <div class="stack">
          <label for="code3">Code de fin de salle</label>
          <div class="code-in">
            <input id="code3" placeholder="Entrez le code re√ßu" autocomplete="off" />
            <button class="btn" id="check3" disabled>Valider</button>
          </div>
          <div class="hint">Le code appara√Æt dans le message de confirmation du formulaire.</div>
        </div>
      </section>
    </div>

    <section class="final" id="final" hidden>
      <h3>üîë Validation finale</h3>
      <p class="muted">Recopie ton code complet et, si besoin, ouvre le formulaire final pour d√©p√¥t officiel.</p>
      <div class="stack">
        <div class="code-in">
          <input id="full" value="EVIDENCE - LIBRE - PARTAGE" />
          <button class="btn" id="copy">Copier</button>
        </div>
        <div class="row">
          <button class="btn" id="openFinal">Ouvrir le Formulaire final</button>
          <span class="pill">Dur√©e : 5 min</span>
        </div>
      </div>
      <div class="footer">Astuce : v√©rifie l‚Äôorthographe et les espaces du code final.</div>
    </section>

    <div class="footer">
      üí° Consignes : Internet autoris√©. Travail individuel. Connexion requise avec votre adresse <span class="kbd">@ipfc-bw.org</span>. ‚Äî ¬© Examen CAP ‚Äì √âducation aux M√©dias & TICE
    </div>
  </main>

  <!-- Modal g√©n√©rique pour int√©grer les formulaires -->
  <dialog id="dlg">
    <div class="modal">
      <div class="head">
        <h2 id="dlgTitle">Formulaire</h2>
        <button class="btn" id="close">Fermer</button>
      </div>
      <div class="body">
        <!-- Remplacez les src par vos liens Google Forms int√©gr√©s -->
        <iframe id="frm" src="about:blank" allowfullscreen></iframe>
      </div>
      <div class="foot">
        <span class="hint">Terminez et envoyez le formulaire. Le code de salle appara√Æt dans le message de confirmation.</span>
      </div>
    </div>
  </dialog>

  <!-- Modal texte pour articles -->
  <dialog id="dlgText">
    <div class="modalText">
      <div class="head">
        <h2 id="dlgTextTitle">Article</h2>
        <button class="btn" id="closeText">Fermer</button>
      </div>
      <div class="body">
        <div id="articleContainer" class="article"></div>
      </div>
      <div class="foot" style="padding:12px 16px; border-top:1px solid #232632; display:flex; justify-content:space-between; align-items:center; gap:10px">
        <div class="row" style="gap:8px">
          <span class="pill">üîé Auteur</span>
          <span class="pill">üìÖ Date</span>
          <span class="pill">üîó Sources</span>
          <span class="pill">üó£Ô∏è Ton</span>
          <span class="pill">üéì R√©f√©rences</span>
        </div>
        <span class="hint">Lis l‚Äôarticle, puis r√©ponds au formulaire (identifie Auteur, Date, Sources, Ton‚Ä¶)</span>
      </div>
    </div>
  </dialog>

  <script>
  // S'assure que le script s'ex√©cute une fois le DOM pr√™t
  document.addEventListener('DOMContentLoaded', ()=>{
    // --- CONFIGUREZ ICI vos liens Google Forms (int√©gr√©s) ---
    // Ouvrez chaque Formulaire > 3 points > Obtenir le lien d'int√©gration > copiez l'URL '.../viewform?embedded=true'
    const FORM_URLS = {
      salle1: "https://forms.gle/YaoAnwf9zuYuguHEA",
      salle2: "https://forms.gle/wYysK8Xpgqsp6NNq6",
      salle3: "https://forms.gle/mQpTbTtZePTBvRdF8",
      final:  "https://forms.gle/HMYkVHFkQ5cz59ck9"
    };

    // --- Codes attendus ---
    const KEYS = { s1: "EVIDENCE", s2: "LIBRE", s3: "PARTAGE" };

    // --- √âtat en m√©moire (par onglet) ---
    const state = { s1:false, s2:false, s3:false };

    // --- Contenus des articles (Salle 1) ---
    const ARTICLE_A = `
      <h4>Les √©crans d√©truisent l‚Äôintelligence des enfants, selon une √©tude choc !</h4>
      <div class="meta">Le R√©veil des Consciences ‚Äì Blog Opinion ‚Äî Publi√© le 3 octobre 2023 ‚Äî Auteur : ¬´ Jules Libre ¬ª</div>
      <p>Une nouvelle √©tude affirme que l‚Äôutilisation quotidienne des √©crans ¬´ r√©duit l‚Äôintelligence des enfants jusqu‚Äô√† 40 % ¬ª. Les chercheurs, dont les noms n‚Äôont pas √©t√© rendus publics, auraient √©tudi√© des milliers d‚Äô√©l√®ves dans plusieurs √©coles. Les r√©sultats sont alarmants : plus les jeunes passent du temps sur tablette et t√©l√©phone, plus leur niveau scolaire s‚Äôeffondre.</p>
      <p>Selon l‚Äô√©tude, les √©crans capturent le cerveau gr√¢ce √† des ondes √©lectromagn√©tiques qui rendent les enfants d√©pendants et passifs. Beaucoup d‚Äôenseignants t√©moignent d‚Äôune baisse dramatique du niveau g√©n√©ral.</p>
      <p>Les parents doivent r√©agir imm√©diatement : il faut <strong>interdire les √©crans</strong> avant qu‚Äôil ne soit trop tard pour la nouvelle g√©n√©ration.</p>
    `;

    const ARTICLE_B = `
      <h4>Temps d‚Äô√©cran : ce que montre r√©ellement la recherche scientifique</h4>
      <div class="meta">Sciences & √âducation ‚Äì Magazine de vulgarisation ‚Äî Publi√© le 21 avril 2023 ‚Äî Auteur : Dr. Claire Dufour (Universit√© de Li√®ge)</div>
      <p>Plusieurs √©tudes r√©centes se sont pench√©es sur l‚Äôimpact du temps d‚Äô√©cran chez les jeunes. Les r√©sultats montrent qu‚Äôil n‚Äôexiste <strong>pas de lien direct</strong> entre l‚Äôutilisation d‚Äôappareils num√©riques et une baisse g√©n√©rale de l‚Äôintelligence.</p>
      <p>Les effets d√©pendent surtout de <strong>l‚Äôusage</strong> : un temps d‚Äô√©cran passif (scroll infini, vid√©os automatis√©es) peut diminuer la capacit√© d‚Äôattention √† court terme, tandis qu‚Äôun usage <strong>actif et guid√©</strong> (applications p√©dagogiques, recherche, cr√©ation num√©rique) peut au contraire renforcer la m√©moire, la logique ou le vocabulaire.</p>
      <p>¬´ La question n‚Äôest pas <em>√©cran ou pas √©cran</em>, mais <em>comment</em>, <em>pour quoi</em>, et <em>pendant combien de temps</em> ¬ª, explique le professeur Martin Ledoux, sp√©cialiste en √©ducation num√©rique √† l‚ÄôUniversit√© de Montr√©al.</p>
      <p>Les chercheurs recommandent un usage accompagn√©, des pauses r√©guli√®res et une <strong>√©ducation aux m√©dias</strong> plut√¥t qu‚Äôune interdiction totale.</p>
    `;

    const $ = (q) => document.querySelector(q);
    const dlg = $('#dlg');
    const iframe = $('#frm');
    const dlgText = document.getElementById('dlgText');
    const articleContainer = document.getElementById('articleContainer');

    function openForm(which){
      const titleMap = {
        salle1: "Salle 1 ‚Äî Analyse critique",
        salle2: "Salle 2 ‚Äî Droit d'auteur",
        salle3: "Salle 3 ‚Äî Outil p√©dagogique",
        final:  "Validation finale"
      };
      $('#dlgTitle').textContent = titleMap[which] || 'Formulaire';
      iframe.src = FORM_URLS[which];
      if(typeof dlg.showModal === 'function'){
        dlg.showModal();
      } else {
        window.open(FORM_URLS[which], '_blank');
      }
    }

    function openText(which){
      const supported = typeof dlgText.showModal === 'function';
      const title = which==='A' ? 'Article A ‚Äî Blog (ton sensationnaliste)' : 'Article B ‚Äî Article scientifique (ton nuanc√©)';
      const body = which==='A' ? ARTICLE_A : ARTICLE_B;
      if(supported){
        document.getElementById('dlgTextTitle').textContent = title;
        articleContainer.innerHTML = body;
        try{ dlgText.showModal(); } catch(err){ /* fallback handled below */ }
      }
      if(!supported || !dlgText.open){
        const w = window.open('', '_blank');
        if(w){
          w.document.write(`<!doctype html><html lang="fr"><head><meta charset="utf-8"><title>${title}</title><style>body{font-family:system-ui,Arial;line-height:1.5;padding:20px;}</style></head><body>${body}</body></html>`);
          w.document.close();
        } else {
          alert('Impossible d‚Äôouvrir la fen√™tre. V√©rifiez le bloqueur de pop-up.');
        }
      }
    }
    // Expose en global pour les attributs onclick √©ventuels
    window.openText = openText;

    // Ouvrir formulaires
    $('#open1')?.addEventListener('click',()=>openForm('salle1'));
    $('#open2')?.addEventListener('click',()=>openForm('salle2'));
    $('#open3')?.addEventListener('click',()=>openForm('salle3'));
    $('#openFinal')?.addEventListener('click',()=>openForm('final'));

    // Boutons articles (au cas o√π pas d'onclick inline)
    document.getElementById('artA')?.addEventListener('click',()=>openText('A'));
    document.getElementById('artB')?.addEventListener('click',()=>openText('B'));

    // Fermetures modales
    document.getElementById('close')?.addEventListener('click',()=>{ dlg.close?.(); iframe.src='about:blank'; });
    document.getElementById('closeText')?.addEventListener('click',()=>{ dlgText.close?.(); articleContainer.innerHTML=''; });
    dlgText?.addEventListener('click',(e)=>{ if(e.target === dlgText){ dlgText.close?.(); articleContainer.innerHTML=''; } });
    window.addEventListener('keydown',(e)=>{ if(e.key==='Escape' && dlgText?.open){ dlgText.close?.(); articleContainer.innerHTML=''; } });

    // Validation des codes de salles
    function ok(elBadge){ elBadge.classList.remove('lock'); elBadge.classList.add('done'); elBadge.textContent='Termin√©'; }

    document.getElementById('check1')?.addEventListener('click',()=>{
      const v = (document.getElementById('code1').value||'').trim().toUpperCase();
      if(v===KEYS.s1){
        state.s1=true; ok(document.getElementById('badge1'));
        document.getElementById('open2').disabled=false; document.getElementById('check2').disabled=false; document.getElementById('badge2').textContent='√Ä faire';
      } else { alert('Code incorrect pour la Salle 1.'); }
      maybeShowFinal();
    });

    document.getElementById('check2')?.addEventListener('click',()=>{
      const v = (document.getElementById('code2').value||'').trim().toUpperCase();
      if(v===KEYS.s2){
        state.s2=true; ok(document.getElementById('badge2'));
        document.getElementById('open3').disabled=false; document.getElementById('check3').disabled=false; document.getElementById('badge3').textContent='√Ä faire';
      } else { alert('Code incorrect pour la Salle 2.'); }
      maybeShowFinal();
    });

    document.getElementById('check3')?.addEventListener('click',()=>{
      const v = (document.getElementById('code3').value||'').trim().toUpperCase();
      if(v===KEYS.s3){
        state.s3=true; ok(document.getElementById('badge3')); maybeShowFinal();
      } else { alert('Code incorrect pour la Salle 3.'); }
    });

    function maybeShowFinal(){
      if(state.s1 && state.s2 && state.s3){
        document.getElementById('final').hidden=false;
        document.getElementById('badge3').scrollIntoView({behavior:'smooth', block:'center'});
      }
    }

    // Copier le code final
    document.getElementById('copy')?.addEventListener('click',()=>{
      const input = document.getElementById('full');
      input.select(); input.setSelectionRange(0, 99999);
      document.execCommand('copy');
    });
  });
</script>
  <script>
    // Ferme correctement le dialog d'iframe si ouvert au chargement
    if(document.getElementById('dlg') && document.getElementById('dlg').open){ document.getElementById('dlg').close(); }
    if(document.getElementById('dlgText') && document.getElementById('dlgText').open){ document.getElementById('dlgText').close(); }
  </script>
</body>
</html>
